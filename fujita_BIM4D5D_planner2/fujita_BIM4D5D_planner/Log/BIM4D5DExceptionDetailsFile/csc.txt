select ISNULL((case when eff_date>PARSE('1/12/2021 10:53:30 PM' as datetime using 'en-US') then eff_date else PARSE('1/12/2021 10:53:30 PM' as datetime using 'en-US') end ),PARSE('1/12/2021 10:53:30 PM' as datetime using 'en-US')) as eff_date,ISNULL((case when eff_date_end < PARSE('1/12/2021 10:53:30 PM' as datetime using 'en-US') then eff_date_end else PARSE('1/12/2021 10:53:30 PM' as datetime using 'en-US') end),PARSE('1/12/2021 10:53:30 PM' as datetime using 'en-US')) as eff_date_end,cost,mv.id material_option_id from material_option mv left outer join(select * from cost_master cm
                                                                        where city_id in (Select id from City where name = N'Delhi' and country_id in (select id from Country_code where country = N'India')) and material_variance_subdiv_id = 700 and(PARSE('1/12/2021 10:53:30 PM' as datetime using 'en-US') between eff_date and eff_date_end
                                                                        or PARSE('1/12/2021 10:53:30 PM' as datetime using 'en-US') between eff_date and eff_date_end)) cm on mv.id = cm.material_option_id ORDER BY material_option_id 